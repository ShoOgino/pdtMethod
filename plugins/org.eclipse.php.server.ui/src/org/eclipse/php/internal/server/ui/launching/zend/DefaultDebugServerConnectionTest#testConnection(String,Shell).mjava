	public void testConnection(String url, Shell shell) {
		fURL = url;
		fShell = shell;

		// check:
		// 1. server is available
		// 2. dummy.php exists 
		// 3. check debugger communication
		// 4. debugger version
		IRunnableWithProgress runnableWithProgress = new IRunnableWithProgress() {
			public void run(IProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
				monitor.beginTask(PHPServerUIMessages.getString("DefaultDebugServerConnectionTest_testingConnectivity"), IProgressMonitor.UNKNOWN); //$NON-NLS-1$
				InputStream inputStream = null;
				try {
					//1. check base URL (http://HOST_NAME)
					//2.check dummy file existence
					final URL checkURL = new URL(fURL + "/dummy.php"); //$NON-NLS-1$
					URLConnection connection = checkURL.openConnection();

					connection.setReadTimeout(DEFAULT_TIMEOUT);
					inputStream = connection.getInputStream();//this will fail when host not found and/or dummy.php not found (2 different exception
					inputStream.close();

					///Build Query String to call debugger via GET
					StringBuilder queryBuilder = new StringBuilder();
					queryBuilder.append(fURL);
					queryBuilder.append("/dummy.php?start_debug=0&debug_port="); //$NON-NLS-1$
					String port = Integer.toString(PHPDebugPlugin.getDebugPort(DebuggerCommunicationDaemon.ZEND_DEBUGGER_ID));
					queryBuilder.append(port);
					queryBuilder.append("&debug_fastfile=1&debug_host="); //$NON-NLS-1$
					String hosts = PHPDebugPlugin.getDebugHosts();
					queryBuilder.append(hosts + "&testConnection=true"); //$NON-NLS-1$
					final String urlToDebug = queryBuilder.toString();

					//Calling the debugger
					URL checkDebugURL = new URL(urlToDebug);
					final URLConnection debugConnection = checkDebugURL.openConnection();
					DebugServerTestController.getInstance().addListener(DefaultDebugServerConnectionTest.this);
					debugConnection.setReadTimeout(DEFAULT_TIMEOUT);
					inputStream = debugConnection.getInputStream();
				} catch (FileNotFoundException fnfe) {//dummy.php was not found
					showErrorDialog(NLS.bind(PHPServerUIMessages.getString("DefaultDebugServerConnectionTest_theURLCouldNotBeFound"), fURL)); //$NON-NLS-1$
					removeThisListener();
				} catch (SocketTimeoutException ste) {
					if (!isFinished) {
						showErrorDialog(NLS.bind(PHPDebugCoreMessages.DebugServerTestEvent_timeOutMessage, fURL)); //$NON-NLS-1$
						removeThisListener();
					}
				} catch (IOException er) {//server not found / server is down
					showErrorDialog(NLS.bind(PHPServerUIMessages.getString("DefaultDebugServerConnectionTest_webServerConnectionFailed"), fURL)); //$NON-NLS-1$
					removeThisListener();
				} finally {
					if (inputStream != null) {
						try {
							inputStream.close();
						} catch (IOException ioe) {
							//nothing to do
						}
					}
				}

			}

		};
		progressDialog = new ProgressMonitorDialog(fShell);
		progressDialog.setBlockOnOpen(false);
		progressDialog.setCancelable(true);

		try {
			progressDialog.run(true, true, runnableWithProgress);
		} catch (Exception e) {
			Logger.logException(e);
		}
	}

