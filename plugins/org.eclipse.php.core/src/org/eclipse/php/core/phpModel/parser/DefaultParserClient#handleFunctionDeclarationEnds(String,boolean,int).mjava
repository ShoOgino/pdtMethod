	public void handleFunctionDeclarationEnds(String functionName, boolean isClassFunction, int endPosition) {
		PHPFunctionData lastFunction = null;
		boolean wasEmpty = functionsStack.isEmpty();
		if (!wasEmpty) {
			lastFunction = (PHPFunctionData) functionsStack.pop();
		}
		if (lastFunction != null) {
			if (lastFunction.getName().equals(functionName)) {
				if (hadReturnStatement) {
					if (lastFunction.getReturnType().equals("void")) {
						((PHPCodeDataFactory.PHPFunctionDataImp) lastFunction).setReturnType("unknown");
					}
				}
				((PHPCodeDataFactory.UserDataImp) lastFunction.getUserData()).setEndPosition(endPosition);
			}
		}

		hadReturnStatement = false;
		super.handleFunctionDeclarationEnds(functionName, isClassFunction, endPosition);
	}

