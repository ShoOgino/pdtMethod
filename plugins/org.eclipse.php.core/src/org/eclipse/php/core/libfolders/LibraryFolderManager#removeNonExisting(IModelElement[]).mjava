	/**
	 * Removes the non-existing model elements from the given array.
	 * 
	 * <p>
	 * The result is returned as new array. The given array remains untouched.
	 * </p>
	 * 
	 * @param elements
	 *            an array of model elements
	 * 
	 * @return a new array that contains only the existing elements of the given
	 *         array
	 */
	private IModelElement[] removeNonExisting(IModelElement[] elements) {
		Collection<IModelElement> existing = new HashSet<IModelElement>();

		for (IModelElement element : elements) {
			if (element.exists()) {
				existing.add(element);
			}
		}

		return existing.toArray(new IModelElement[existing.size()]);
	}

