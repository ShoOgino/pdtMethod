	public boolean visit(TypeDeclaration type) throws Exception {
		if (type instanceof NamespaceDeclaration) {
			NamespaceDeclaration nsDecl = (NamespaceDeclaration) type;
			if (pendingNsDeclaration != null) {
				endvisit(pendingNsDeclaration);
				pendingNsDeclaration = null;
			}
			if (nsDecl.getName() == NamespaceDeclaration.GLOBAL) { // we don't handle global namespaces
				return true;
			}
		}
		
		// In case we are entering a nested element 
		if (!declarations.empty() && declarations.peek() instanceof MethodDeclaration) {
			deferredDeclarations.add(type);
			return false;
		}
		
		declarations.push(type);
		
		for (PHPSourceElementRequestorExtension visitor : extensions) {
			visitor.visit(type);
		}
		return super.visit(type);
	}

