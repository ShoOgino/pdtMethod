	private static Result<?, ?> searchInBuildpathEntry(String path,
			IBuildpathEntry entry, IProject currentProject) {

		IPath entryPath = EnvironmentPathUtils.getLocalPath(entry.getPath());

		if (entry.getEntryKind() == IBuildpathEntry.BPE_LIBRARY) {
			File entryDir = entryPath.toFile();
			File file = new File(entryDir, path);
			if (file.exists()) {
				return new IncludedFileResult(entry, file);
			}
		} else if (entry.getEntryKind() == IBuildpathEntry.BPE_VARIABLE) {
			entryPath = DLTKCore.getResolvedVariablePath(entryPath);
			File entryDir = entryPath.toFile();
			File file = new File(entryDir, path);
			if (file.exists()) {
				return new IncludedFileResult(entry, file);
			}
		} else if (entry.getEntryKind() == IBuildpathEntry.BPE_PROJECT) {
			IWorkspaceRoot workspaceRoot = ResourcesPlugin.getWorkspace()
					.getRoot();
			IProject project = workspaceRoot.getProject(entryPath.segment(0));
			if (project.isAccessible()) {
				IResource resource = project.findMember(path);
				if (resource instanceof IFile) {
					return new ResourceResult((IFile) resource);
				}
			}
		} else if (entry.getEntryKind() == IBuildpathEntry.BPE_SOURCE) {
			IWorkspaceRoot workspaceRoot = ResourcesPlugin.getWorkspace()
					.getRoot();
			IResource resource = workspaceRoot.findMember(entryPath);
			if (resource instanceof IContainer) {
				resource = ((IContainer) resource).findMember(path);
				if (resource instanceof IFile) {
					return new ResourceResult((IFile) resource);
				}
			}
		} else if (entry.getEntryKind() == IBuildpathEntry.BPE_CONTAINER) {
			try {
				IScriptProject scriptProject = DLTKCore.create(currentProject);
				IBuildpathContainer container = DLTKCore.getBuildpathContainer(
						entry.getPath(), scriptProject);
				if (container != null) {
					IBuildpathEntry[] buildpathEntries = container
							.getBuildpathEntries(scriptProject);
					if (buildpathEntries != null) {
						for (IBuildpathEntry buildpathEntry : buildpathEntries) {
							Result<?, ?> result = searchInBuildpathEntry(path,
									buildpathEntry, currentProject);
							if (result != null) {
								IProjectFragment[] projectFragments = scriptProject
										.findProjectFragments(entry);
								((IncludedFileResult) result)
										.setProjectFragments(projectFragments);
								return result;
							}
						}
					}
				}
			} catch (ModelException e) {
				PHPCorePlugin.log(e);
			}
		}

		return null;
	}

