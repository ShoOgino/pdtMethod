	/**
	 * Returns type of a class field defined by name.
	 * @param types
	 * @param propertyName
	 * @param offset
	 * @param line
	 * @param determineObjectFromOtherFile
	 * @return
	 */
	public static IType[] getVariableType(IType[] types, String propertyName, int offset, int line, boolean determineObjectFromOtherFile) {
		for (IType type : types) {
			IField[] fields = getClassFields(type, propertyName, true, false);

			Set<String> processedFields = new HashSet<String>();
			for (IField field : fields) {
				if (processedFields.contains(field.getElementName())) {
					continue;
				}
				processedFields.add(field.getElementName());

				ModuleDeclaration moduleDeclaration = SourceParserUtil.getModuleDeclaration(field.getSourceModule(), null);
				BasicContext sourceModuleContext = new BasicContext(field.getSourceModule(), moduleDeclaration);
				ClassVariableDeclarationGoal goal = new ClassVariableDeclarationGoal(sourceModuleContext, types, field.getElementName());
				PHPTypeInferencer typeInferencer = new PHPTypeInferencer();
				IEvaluatedType evaluatedType = typeInferencer.evaluateType(goal);
				
				IModelElement[] modelElements = PHPTypeInferenceUtils.getModelElements(evaluatedType, sourceModuleContext, !determineObjectFromOtherFile);
				if (modelElements != null) {
					return modelElementsToTypes(modelElements);
				}
			}
		}
		return null;
	}

