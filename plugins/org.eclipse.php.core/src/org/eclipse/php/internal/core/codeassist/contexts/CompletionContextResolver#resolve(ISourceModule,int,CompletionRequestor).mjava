	public ICompletionContext[] resolve(ISourceModule sourceModule, int offset, CompletionRequestor requestor) {
		List<ICompletionContext> result = new LinkedList<ICompletionContext>();
		// find correct completion contexts according to known information:
		for (ICompletionContext context : createContexts()) {
			try {
				if (context.isValid(sourceModule, offset, requestor)) {
					result.add(context);
				}
			} catch (Exception e) {
				if (DLTKCore.DEBUG_COMPLETION) {
					e.printStackTrace(); // allow processing of other contexts
				}
			}
		}
		
		// remove exclusive contexts:
		if (result.size() > 1) {
			List<ICompletionContext> filteredResult = new LinkedList<ICompletionContext>();
			for (ICompletionContext context : result) {
				if (!context.isExclusive()) {
					filteredResult.add(context);
				}
			}
			result = filteredResult;
		}
		
		return result.toArray(new ICompletionContext[result.size()]);
	}

