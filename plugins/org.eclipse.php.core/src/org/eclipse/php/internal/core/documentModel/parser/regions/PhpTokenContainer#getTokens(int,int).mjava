	public synchronized ITextRegion[] getTokens(final int offset, final int length) throws BadLocationException {
		assert length >= 0;
		List<ITextRegion> result = new ArrayList<ITextRegion>(); // list of ITextRegion

		ITextRegion token = getToken(offset);
		// Checks that the token is within the given limits 
		if (token.getEnd() <= offset + length) {
			result.add(token);
		}

		while (tokensIterator.hasNext()) {
			final ContextRegion newtoken = tokensIterator.next();
			if (newtoken != token) {
				if (newtoken.getEnd() <= offset + length) {
					result.add(newtoken);
				} else {
					break;
				}
			}
			token = newtoken;
		}

		return result.toArray(new ITextRegion[result.size()]);
	}

