	protected void showClassList(String prefix, int offset, States state) {
		this.setSourceRange(offset - prefix.length(), offset);
		int relevanceClass = RELEVANCE_CLASS;

		switch (state) {
			case NEW:
				int mask = CodeAssistUtils.ONLY_CLASSES;
				if (requestor.isContextInformationMode()) {
					mask |= CodeAssistUtils.EXACT_NAME;
				}
				IType[] types = CodeAssistUtils.getGlobalTypes(sourceModule, prefix, mask);
				IType enclosingClass = null;
				try {
					IModelElement enclosingElement = sourceModule.getElementAt(offset);
					if (enclosingElement instanceof IMethod) {
						IModelElement parent = ((IMethod)enclosingElement).getParent();
						if (parent instanceof IType) {
							enclosingClass = (IType) parent;
						}
					}
				} catch (ModelException e) {
					if (DEBUG) {
						e.printStackTrace();
					}
				}
				
				for (IType type : types) {
					try {
						IMethod ctor = null;
						for (IMethod method : type.getMethods()) {
							if (method.isConstructor()) {
								ctor = method;
								break;
							}
						}
						if (ctor != null) {
							if ((ctor.getFlags() & IPHPModifiers.AccPrivate) == 0 || type.equals(enclosingClass)) {
								FakeMethod ctorMethod = new FakeMethod((ModelElement) type, type.getElementName()) {
									public boolean isConstructor() throws ModelException {
										return true;
									}
								};
								ctorMethod.setParameters(ctor.getParameters());
								reportMethod(ctorMethod, relevanceClass--);
							}
						} else {
							if ((type.getFlags() & IPHPModifiers.Internal) == 0) {
								reportType(type, relevanceClass--, hasOpenBraceAtEnd ? EMPTY : BRACKETS_SUFFIX);
							}
						}
					} catch (ModelException e) {
						if (DLTKCore.DEBUG_COMPLETION) {
							e.printStackTrace();
						}
					}
				}
				if (CodeAssistUtils.startsWithIgnoreCase(SELF, prefix)) {
					if (!requestor.isContextInformationMode() || prefix.length() == SELF.length()) {
						// get the class data for "self". In case of null, the self function will not be added
						IType selfClassData = CodeAssistUtils.getSelfClassData(sourceModule, offset);
						if (selfClassData != null) {
							addSelfFunctionToProposals(selfClassData);
						}
					}
				}
				break;
			case INSTANCEOF:
				mask = 0;
				if (requestor.isContextInformationMode()) {
					mask |= CodeAssistUtils.EXACT_NAME;
				}
				IType[] typeElements = CodeAssistUtils.getGlobalTypes(sourceModule, prefix, mask);
				for (IType typeElement : typeElements) {
					try {
						if ((typeElement.getFlags() & IPHPModifiers.Internal) == 0) {
							reportType(typeElement, relevanceClass--, EMPTY);
						}
					} catch (ModelException e) {
						if (DLTKCore.DEBUG_COMPLETION) {
							e.printStackTrace();
						}
					}
				}
				if (CodeAssistUtils.startsWithIgnoreCase(SELF, prefix)) {
					if (!requestor.isContextInformationMode() || prefix.length() == SELF.length()) {
						// get the class data for "self". In case of null, the self function will not be added
						IType selfClassData = CodeAssistUtils.getSelfClassData(sourceModule, offset);
						if (selfClassData != null) {
							addSelfFunctionToProposals(selfClassData);
						}
					}
				}
				break;
			case CATCH:
				mask = 0;
				if (requestor.isContextInformationMode()) {
					mask |= CodeAssistUtils.EXACT_NAME;
				}
				typeElements = CodeAssistUtils.getGlobalTypes(sourceModule, prefix, mask);
				for (IType typeElement : typeElements) {
					try {
						if ((typeElement.getFlags() & IPHPModifiers.Internal) == 0) {
							reportType(typeElement, relevanceClass--, EMPTY);
						}
					} catch (ModelException e) {
						if (DLTKCore.DEBUG_COMPLETION) {
							e.printStackTrace();
						}
					}
				}
				break;
			default:
				break;
		}
	}

