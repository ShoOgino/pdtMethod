	/**
	 * This implementation updates the php tokens model after updating WST editor model
	 */
	public StructuredDocumentEvent reparse() {
		final StructuredDocumentEvent documentEvent = super.reparse();
		
		if (documentEvent instanceof RegionChangedEvent) {
			// safe cast
			RegionChangedEvent event = (RegionChangedEvent) documentEvent;
			final ITextRegion region = event.getRegion();

			// if it is a php script region - reparse the php tokens according to the new text 
			if (region.getType() == PHPRegionContext.PHP_CONTENT) {
				final int startOffset = event.getStructuredDocumentRegion().getStartOffset();
				try {
					PhpScriptRegion phpRegion = (PhpScriptRegion) region;
					final int phpRegionStart = startOffset + region.getStart();
					final String newText = documentEvent.getDocument().get(phpRegionStart, region.getLength());
					final boolean reparse = phpRegion.reparse(event.fText, newText, event.fOffset - phpRegionStart , event.getDeletedText());
					if (!reparse) {
						// complete reparsing for the php script
						phpRegion.completeReparse(newText);
						
						// update the event
						return event; 
					}
				} catch (BadLocationException e) {
					Logger.logException(e);
				}
			}
		}

		return documentEvent;
	}

