	/**
	 * Analyzes file dependences, and builds tree of all source modules, which are referenced by the given source module.
	 * @param file Source module
	 * @param monitor Progress monitor
	 * @return reference tree
	 */
	public static ReferenceTreeNode buildReferencedFilesTree(ISourceModule file, IProgressMonitor monitor) {
		ReferenceTreeNode tree = new ReferenceTreeNode(file);

		HashSet<ISourceModule> processedFiles = new HashSet<ISourceModule>();
		processedFiles.add(file);

		try {
			internalBuildReferencedFilesTree(tree, processedFiles, monitor);
		} catch (CoreException e) {
			Logger.logException(e);
		}
		return tree;
	}

