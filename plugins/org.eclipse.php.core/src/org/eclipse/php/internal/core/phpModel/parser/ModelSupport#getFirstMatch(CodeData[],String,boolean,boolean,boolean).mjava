	//Binary search for the search start position
	private static int getFirstMatch(CodeData[] sortedArray, String searchName, boolean exactName, boolean useComparableName, boolean caseSensitive) {
		// if the searched name is empty.
		int searchNameLength = searchName.length();
		if (searchNameLength == 0) {
			if (exactName) {
				return -1;
			}
			return 0;
		}
		// if the array is empty.
		if (sortedArray == null || sortedArray.length == 0) {
			return -1;
		}
		// small Array, we use simple search.
		if (sortedArray.length < SMALL_ARRAY_SIZE) {
			for (int i = 0; i < sortedArray.length; i++) {
				String name = useComparableName ? ((ComparableName) sortedArray[i]).getComparableName() : sortedArray[i].getName();
				if (!exactName && name.length() > searchNameLength) {
					name = name.substring(0, searchNameLength);
				}
				if (caseSensitive) {
					if (searchName.equals(name)) {
						return i;
					}
				} else if (searchName.equalsIgnoreCase(name)) {
					return i;
				}
			}
			return -1;
		}

		// binary search.
		int start = 0;
		int end = sortedArray.length - 1;
		while (start <= end) {
			int mid = start + end >> 1;
			String name = useComparableName ? ((ComparableName) sortedArray[mid]).getComparableName() : sortedArray[mid].getName();
			if (!exactName && name.length() > searchNameLength) {
				name = name.substring(0, searchNameLength);
			}
			int compareResult = caseSensitive ? name.compareTo(searchName) : name.compareToIgnoreCase(searchName);
			if (compareResult == 0) {
				start = mid;
				break;
			}
			if (compareResult != 0) {
				start = mid + 1;
			} else {
				end = mid - 1;
			}
		}
		// verify result.
		if (start < 0 || start >= sortedArray.length) {
			return -1;
		}
		String name = useComparableName ? ((ComparableName) sortedArray[start]).getComparableName() : sortedArray[start].getName();
		if (!exactName && name.length() > searchNameLength) {
			name = name.substring(0, searchNameLength);
		}
		if (caseSensitive) {
			if (!name.equals(searchName)) {
				return -1;
			}
		} else if (!name.equalsIgnoreCase(searchName)) {
			return -1;
		}
		// find the first matching name.
		for (start -= 1; start >= 0; start--) {
			name = useComparableName ? ((ComparableName) sortedArray[start]).getComparableName() : sortedArray[start].getName();
			if (!exactName && name.length() > searchNameLength) {
				name = name.substring(0, searchNameLength);
			}
			if (caseSensitive) {
				if (!name.equals(searchName)) {
					break;
				}
			} else if (!name.equalsIgnoreCase(searchName)) {
				break;
			}
		}
		return start + 1;
	}

