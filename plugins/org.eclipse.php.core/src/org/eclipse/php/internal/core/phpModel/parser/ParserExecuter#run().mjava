	/**
	 * The parsing action - in a separate (async) thread
	 * The mutex keeps that only one parsing will be performed  
	 */
	public final void run() {
		synchronized (mutex) {
			try {

				final CompletionLexer lexer = parserManager.createCompletionLexer(reader);
				lexer.setUseAspTagsAsPhp(useAspTagsAsPhp);
				lexer.setParserClient(client);
				lexer.setTasksPatterns(tasksPatterns);

				if (phpParser == null) {
					phpParser = parserManager.createPhpParser();
				}
				phpParser.setScanner(lexer);
				phpParser.setParserClient(client);

				client.startParsing(filename);

				phpParser.parse();

			} catch (Exception e) {
				Logger.logException(e);

			} finally {

				try {
					if (client != null && phpParser != null) {
						client.finishParsing(phpParser.getLength(), phpParser.getCurrentLine(), lastModified);
					}

				} catch (Exception ex) {
					Logger.logException(ex);

				} finally {
					try {
						reader.close();
					} catch (IOException exception) {
						Logger.logException(exception);
					}
				}
			}
		}
	}

