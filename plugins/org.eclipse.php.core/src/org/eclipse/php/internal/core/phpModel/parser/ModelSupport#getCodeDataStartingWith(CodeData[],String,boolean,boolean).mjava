	private static CodeData[] getCodeDataStartingWith(CodeData[] sortedArray, String startsWith, boolean useComparableName, boolean caseSensitive) {
		if (sortedArray == null) {
			sortedArray = PHPCodeDataFactory.EMPTY_CODE_DATA_ARRAY;
		}
		if (startsWith == null || startsWith.equals(EMPTY_STRING) || sortedArray.length == 0) {
			return sortedArray;
		}

		int start = getFirstMatch(sortedArray, startsWith, false, useComparableName, caseSensitive);
		if (start < 0) {
			return PHPCodeDataFactory.EMPTY_CODE_DATA_ARRAY;
		}

		int end = sortedArray.length - 1;
		int length = startsWith.length();
		for (int i = start; i < sortedArray.length; i++) {
			String name = useComparableName ? ((ComparableName) sortedArray[i]).getComparableName() : sortedArray[i].getName();
			name = (name.length() > length) ? name.substring(0, length) : name;
			if (caseSensitive) {
				if (name.compareTo(startsWith) > 0) {
					end = i - 1;
					break;
				}
			} else if (name.compareToIgnoreCase(startsWith) > 0) {
				end = i - 1;
				break;
			}
		}
		int arrayLength = (end < start) ? 0 : end - start + 1;
		CodeData[] rv = new CodeData[arrayLength];
		System.arraycopy(sortedArray, start, rv, 0, rv.length);
		return rv;
	}

