	public IGoal[] init() {
		ClassVariableDeclarationGoal typedGoal = (ClassVariableDeclarationGoal) goal;
		IType[] types = typedGoal.getTypes();

		if (types == null) {
			InstanceContext context = (InstanceContext) typedGoal.getContext();
			types = getTypes(context.getInstanceType(), context.getSourceModule());
		}

		String variableName = typedGoal.getVariableName();
		SearchEngine searchEngine = new SearchEngine();
		SearchParticipant[] participants = new SearchParticipant[] { SearchEngine.getDefaultSearchParticipant() };

		final List<IGoal> subGoals = new LinkedList<IGoal>();
		for (final IType type : types) {
			final ISourceModule sourceModule = type.getSourceModule();
			final ModuleDeclaration moduleDeclaration = SourceParserUtil.getModuleDeclaration(sourceModule);
			
			SearchRequestor requestor = new SearchRequestor() {
				public void acceptSearchMatch(SearchMatch match) throws CoreException {
					Object element = match.getElement();
					if (element instanceof SourceRefElement) {
						SourceRefElement sourceRefElement = (SourceRefElement) element;
						ISourceRange sourceRange = sourceRefElement.getSourceRange();
						ClassDeclarationSearcher searcher = new ClassDeclarationSearcher(sourceModule, moduleDeclaration, sourceRange.getOffset(), sourceRange.getLength());
						try {
							moduleDeclaration.traverse(searcher);
							if (searcher.getResult() != null) {
								subGoals.add(new ExpressionTypeGoal(searcher.getContext(), searcher.getResult()));
							}
						} catch (Exception e) {
							Logger.logException(e);
						}
					}
				}
			};
			try {
				IDLTKSearchScope scope;
				SearchPattern pattern = SearchPattern.createPattern(variableName, IDLTKSearchConstants.FIELD, IDLTKSearchConstants.DECLARATIONS, SearchPattern.R_EXACT_MATCH, PHPLanguageToolkit.getDefault());

				scope = SearchEngine.createSearchScope(type);
				searchEngine.search(pattern, participants, scope, requestor, null);

				if (type.getSuperClasses() != null) {
					scope = SearchEngine.createSuperHierarchyScope(type);
					searchEngine.search(pattern, participants, scope, requestor, null);
				}
			} catch (CoreException e) {
				Logger.logException(e);
			}
		}

		resolveMagicClassVariableDeclaration(types, variableName);

		return subGoals.toArray(new IGoal[subGoals.size()]);
	}

