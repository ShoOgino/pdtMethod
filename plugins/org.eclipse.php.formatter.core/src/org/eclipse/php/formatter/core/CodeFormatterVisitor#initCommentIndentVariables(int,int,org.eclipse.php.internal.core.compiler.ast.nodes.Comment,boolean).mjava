	private void initCommentIndentVariables(int offset, int startLine,
			org.eclipse.php.internal.core.compiler.ast.nodes.Comment comment,
			boolean endWithNewLineIndent) throws BadLocationException {
		// TODO the value should be calculated from ReplaceEdit changes
		indentLengthForComment = 0;
		indentStringForComment = ""; //$NON-NLS-1$
		IRegion startRegion = document.getLineInformation(startLine);
		String startLineContent = document.get(startRegion.getOffset(),
				comment.sourceStart() + offset - startRegion.getOffset())
				.trim();
		// indentStringForComment = FormatterUtils.getLineBlanks(document,
		// startRegion);

		StringBuffer sb = new StringBuffer();
		int lastIndentationLevel = indentationLevel;
		if (endWithNewLineIndent) {
			if (indentationLevelList.size() >= 2) {
				lastIndentationLevel = indentationLevelList
						.get(indentationLevelList.size() - 2);
			} else {
				lastIndentationLevel = indentationLevelList
						.get(indentationLevelList.size() - 1);
			}
		} else {
			lastIndentationLevel = indentationLevelList
					.get(indentationLevelList.size() - 1);
		}
		for (int i = 0; i < lastIndentationLevel * preferences.indentationSize; i++) {
			sb.append(preferences.indentationChar);
		}
		for (int i = 0; i < startLineContent.length(); i++) {
			sb.append(" "); //$NON-NLS-1$
		}
		if (startLineContent.length() > 0) {
			sb.append(" "); //$NON-NLS-1$
		}
		indentStringForComment = sb.toString();
		char[] blankArray = indentStringForComment.toCharArray();
		for (int i = 0; i < blankArray.length; i++) {
			if (blankArray[i] == '\t') {
				indentLengthForComment += 3;
			} else {
				indentLengthForComment++;
			}
		}
	}

