	public void formatFile(IFile file) throws IOException, CoreException {
		if (file == null) {
			return;
		}

		IStructuredModel structuredModel = null;

		structuredModel = StructuredModelManager.getModelManager()
				.getModelForEdit(file);
		if (structuredModel == null) {
			return;
		}
		try {
			// setup structuredModel
			// Note: We are getting model for edit. Will save model if model
			// changed.
			IStructuredDocument structuredDocument = structuredModel
					.getStructuredDocument();

			IRegion region = new Region(0, structuredDocument.getLength());

			formatter.format(structuredDocument, region);
			// save model if needed - used for closed files
			if (!structuredModel.isSharedForEdit()
					&& structuredModel.isSaveNeeded()) {
				structuredModel.save();
			}
		} finally {
			// release from model manager
			if (structuredModel != null) {
				structuredModel.releaseFromEdit();
			}
		}

	}

