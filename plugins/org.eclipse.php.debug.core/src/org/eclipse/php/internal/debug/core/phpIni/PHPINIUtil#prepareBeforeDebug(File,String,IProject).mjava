	/**
	 * Make some preparations before debug session:
	 * <ul>
	 * 	<li>Adds include path
	 * 	<li>Modifies Zend Debugger path in the PHP configuration file
	 * </ul>
	 *
	 * @param phpIniFile PHP configuration file instance
	 * @param phpExePath Path to the PHP executable
	 * @param project Current project
	 * @return created temporary PHP configuration file
	 */
	public static File prepareBeforeDebug(File phpIniFile, String phpExePath, IProject project) {
		File tempIniFile = createTemporaryPHPINIFile(phpIniFile);

		// Modify include path:
		if (project != null) {
			IncludePath[] path = PHPSearchEngine.buildIncludePath(project);
			List<String> includePath = new ArrayList<String>(path.length);
			
			for (IncludePath pathObject : path) {
				if (pathObject.isBuildpath()) {
					IBuildpathEntry entry = (IBuildpathEntry) pathObject.getEntry();
					
					if (entry.getEntryKind() == IBuildpathEntry.BPE_VARIABLE) {
						IPath entryPath = DLTKCore.getResolvedVariablePath(entry.getPath());
						includePath.add(entryPath.toFile().getAbsolutePath());
					} else if (entry.getEntryKind() == IBuildpathEntry.BPE_PROJECT || entry.getEntryKind() == IBuildpathEntry.BPE_SOURCE || entry.getEntryKind() == IBuildpathEntry.BPE_LIBRARY) {
						IPath entryPath = EnvironmentPathUtils.getLocalPath(entry.getPath());
						IResource resource = ResourcesPlugin.getWorkspace().getRoot().findMember(entryPath);
						if (resource != null) {
							IPath location = resource.getLocation();
							if (location != null) {
								includePath.add(location.toOSString());
							}
						} else {
							includePath.add(entryPath.toOSString());
						}
					}
				} else {
					IContainer container = (IContainer) pathObject.getEntry();
					IPath location = container.getLocation();
					if (location != null) {
						includePath.add(location.toOSString());
					}
				}
			}
			modifyIncludePath(tempIniFile, includePath.toArray(new String[includePath.size()]));
		}

		// Modify Zend Debugger extension entry:
		if (phpIniFile != null) {
			File debuggerFile = new File(phpIniFile.getParentFile(), Platform.OS_WIN32.equals(Platform.getOS()) ? "ZendDebugger.dll" : "ZendDebugger.so"); //$NON-NLS-1$ //$NON-NLS-2$
			if (debuggerFile.exists()) {
				modifyDebuggerExtensionPath(tempIniFile, debuggerFile.getAbsolutePath());
			}
			
			modifyExtensionDir(tempIniFile, debuggerFile.getParentFile().getAbsolutePath());
		}
		
		if (PHPDebugPlugin.DEBUG) {
			System.out.println ("\nPHP.ini contents:\n---------------------");
			try {
				BufferedReader r = new BufferedReader(new FileReader(tempIniFile));
				String line;
				while ((line = r.readLine()) != null) {
					System.out.println(line);
				}
				r.close();
				System.out.println();
			} catch (IOException e) {
			}
		}
		
		return tempIniFile;
	}

