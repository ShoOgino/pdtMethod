	/**
	 * create and send the breakpoint add command
	 * 
	 * @param bp
	 * @param onResponseThread
	 */
	private void sendBreakpointAddCmd(DBGpBreakpoint bp, boolean onResponseThread) {
		bp.resetConditionChanged();
		String fileName = bp.getFileName();
		int lineNumber = bp.getLineNumber();

		// create the add breakpoint command
		String debugMsg = null;
		if (DBGpLogger.debugBP()) {
			debugMsg = "adding breakpoint to file:" + fileName + ", at Line Number: " + lineNumber; //$NON-NLS-1$ //$NON-NLS-2$
		}
		fileName = mapToExternalFileIfRequired(bp);

		String args = "-t line -f " + DBGpUtils.getFileURIString(fileName) + " -n " + lineNumber; //$NON-NLS-1$ //$NON-NLS-2$

		DBGpBreakpointCondition condition = new DBGpBreakpointCondition(bp);
		if (condition.getType() == DBGpBreakpointCondition.EXPR) {
			if (debugMsg != null) {
				debugMsg += " with expression:" + condition.getExpression(); //$NON-NLS-1$
			}
			
			//we use session encoding before converting to Base64.
			args += " -- " + Base64.encode(getSessionEncodingBytes(condition.getExpression())); //$NON-NLS-1$
		} else if (condition.getType() == DBGpBreakpointCondition.HIT) {
			if (debugMsg != null) {
				debugMsg += " with hit :" + condition.getHitCondition() + condition.getHitValue(); //$NON-NLS-1$
			}
			args += " -h " + condition.getHitValue() + " -o " + condition.hitCondition; //$NON-NLS-1$ //$NON-NLS-2$
		}
		if (debugMsg != null) {
			DBGpLogger.debug(debugMsg);
		}

		DBGpResponse resp;
		if (onResponseThread) {
			resp = session.sendSyncCmdOnResponseThread(DBGpCommand.breakPointSet, args);
		} else {
			resp = session.sendSyncCmd(DBGpCommand.breakPointSet, args);
		}
		if (DBGpUtils.isGoodDBGpResponse(this, resp)) {
			/*
			 * <response command="breakpoint_set"
			 * transaction_id="TRANSACTION_ID" state="STATE"
			 * id="BREAKPOINT_ID"/>
			 */
			// TODO: note that you don't get state from XDebug even though the
			// document says so, assume optional and if not provided, assume bp is
			// enabled.
			String bpId = resp.getTopAttribute("id"); //$NON-NLS-1$
			// luckily even though it is a string, the XDebug implementation
			// defines the id as being a c int.
			bp.setID(Integer.parseInt(bpId));
			if (DBGpLogger.debugBP()) {
				DBGpLogger.debug("Breakpoint installed with id: " + bpId); //$NON-NLS-1$
			}
		} else {
			// we have already logged the issue as an error
		}
	}

