	/**
	 * configure the Proxy Handler from the preferences.
	 */
	public void configure() {
		//TODO: move to using preference manager completely.
		Preferences prefs = XDebugPreferenceMgr.getPreferences();
		
		useProxy = prefs.getBoolean(XDebugPreferenceMgr.XDEBUG_PREF_USEPROXY);
		if (useProxy == false) {
			unregister();
		}
		else {
			int idePort = XDebugPreferenceMgr.getPort(prefs);			
			String ideKey = prefs.getString(XDebugPreferenceMgr.XDEBUG_PREF_IDEKEY);
			boolean multisession = XDebugPreferenceMgr.useMultiSession(); 
			String proxy = prefs.getString(XDebugPreferenceMgr.XDEBUG_PREF_PROXY);
			String proxyHost = proxy;
			int proxyPort = -1;
			int split = proxy.indexOf(':');
			if (split != -1) {
				proxyHost = proxy.substring(0, split);
				if (split + 1 < proxy.length()) {
					String portStr = proxy.substring(split + 1);
					try {
						proxyPort = Integer.parseInt(portStr);
					} catch (NumberFormatException e) {
					}
				}
			}
			
			setProxyInfo(proxyHost, proxyPort, ideKey, idePort, multisession);
			if (XDebugPreferenceMgr.getAcceptRemoteSession() != AcceptRemoteSession.off) {
				// if jit we must register with the proxy straight away rather than wait
				// for the first launch
				if (registerWithProxy() == false) {
					displayErrorMessage("Unable to connect to proxy\n" + getErrorMsg());
				}
			}
		}
	}

