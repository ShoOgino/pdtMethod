	private String addIndent(String result, int offset) {
		final String[] lines = TextUtils.splitLines(result);
		if (lines.length > 1) {
			final String delimeter = TextUtilities.getDefaultLineDelimiter(document);
			final String indent = calculateIndent(document, offset);
			final StringBuffer buffer = new StringBuffer(lines[0]);

			// Except first line
			for (int i = 1; i < lines.length; i++) {
				buffer.append(delimeter);
				buffer.append(indent);
				buffer.append(lines[i]);
			}
			return buffer.toString();
		}
		return result;
	}

