	private BPListElement[] openExtZipFileDialog(BPListElement existing,
			IEnvironment environment) {
		if (existing == null) {
			IPath[] selected = BuildpathDialogAccess
					.chooseExternalArchiveEntries(getShell(), environment);
			if (selected != null) {
				ArrayList res = new ArrayList();
				for (int i = 0; i < selected.length; i++) {
					res.add(new BPListElement(fCurrJProject,
							IBuildpathEntry.BPE_LIBRARY, selected[i], null,
							true));
				}
				return (BPListElement[]) res.toArray(new BPListElement[res
						.size()]);
			}
		} else {
			IPath configured = BuildpathDialogAccess
					.configureExternalArchiveEntry(getShell(), existing
							.getPath());
			if (configured != null) {
				return new BPListElement[] { new BPListElement(fCurrJProject,
						IBuildpathEntry.BPE_LIBRARY, configured, null, true) };
			}
		}
		return null;
	}

