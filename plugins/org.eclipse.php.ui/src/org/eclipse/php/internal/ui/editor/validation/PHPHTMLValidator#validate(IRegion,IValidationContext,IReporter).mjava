	public void validate(IRegion dirtyRegion, IValidationContext helper, IReporter reporter) {
		//handle the cases that the connect() run before the structured model was created (look at innerConnect()).
		
		if (currentFileName == null && fDocument != null) {
			innerConnect();
		}
		int offset = dirtyRegion.getOffset();
		ITypedRegion typedRegion;
		try {
			typedRegion = fDocument.getPartition(offset);
		} catch (BadLocationException e) {
			Logger.logException(e);
			return;
		}

		final String type = typedRegion.getType();
		if (type.equals(IHTMLPartitions.HTML_DEFAULT)) {
			IStructuredModel structuredModel = null;
			structuredModel = StructuredModelManager.getModelManager().getExistingModelForRead(fDocument);
			DOMModelForPHP domModelForPHP = (DOMModelForPHP) structuredModel;
			IFile documentFile = domModelForPHP.getIFile();
			structuredModel.releaseFromRead();
			//added a test if external file in order not to get exception
			//when getting the IFile instance of the document
			//An exception is thrown when segmentCount == 1 (C:\file.php for example) 
			if (ExternalFilesRegistry.getInstance().isEntryExist(documentFile.getFullPath().toString())) {
				validateHTMLForExternalDocument(dirtyRegion, helper, reporter);
			} else {
				super.validate(dirtyRegion, helper, reporter);
			}
			return;
		}
	}

