	/**
	 * Prepares the regions for coloring by analyzing the tokens
	 */
	public boolean prepareRegions(ITypedRegion typedRegion, int lineRequestStart, int lineRequestLength, Collection holdResults) {
		final int partitionStartOffset = typedRegion.getOffset();
		final int partitionLength = typedRegion.getLength();
		IStructuredDocumentRegion structuredDocumentRegion = getDocument().getRegionAtCharacterOffset(partitionStartOffset);
		final boolean prepareTextRegions = prepareTextRegions(structuredDocumentRegion, partitionStartOffset, partitionLength, holdResults);
		
		// update text presentation listeners about the change
		if (prepareTextRegions) {
			Region damage = new Region(partitionStartOffset, partitionLength);
			StyleRange[] array = (StyleRange[]) holdResults.toArray(new StyleRange[holdResults.size()]);
			final TextPresentation presentation = createPresentation(damage, array);
			fHighlighter.getTextViewer().changeTextPresentation(presentation, false);
		}		
		return prepareTextRegions;
	}

