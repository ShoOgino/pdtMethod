		@Override
		public void apply(IDocument document) {

			SelectionDialog dialog = createTypeDialog();
			int result = dialog.open();
			if (result != IDialogConstants.OK_ID) {
				return;
			}

			TextEdit textEdit = null;
			Object[] types = dialog.getResult();
			if (types != null && types.length == 1 && types[0] instanceof IModelElement) {
				try {
					textEdit = createTextEditForType(document, (IModelElement) types[0]);
				} catch (BadLocationException e) {
				}
			}

			if (null != textEdit) {
				try {
					textEdit.apply(document);
				} catch (MalformedTreeException e) {
				} catch (BadLocationException e) {
				}
			}
		}

