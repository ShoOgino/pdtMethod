	@Override
	public TemplateBuffer evaluate(Template template)
			throws BadLocationException, TemplateException {
		boolean useTab = getPreferences().getBoolean(PHPCorePlugin.ID,
				PHPCoreConstants.FORMATTER_USE_TABS);
		if (!useTab) {
			String lengthString = getPreferences().getString(PHPCorePlugin.ID,
					PHPCoreConstants.FORMATTER_INDENTATION_SIZE);
			int length = FormatPreferencesSupport.getInstance()
					.getIndentationSize(null);
			if (lengthString != null && lengthString.trim().length() != 0) {
				try {
					length = Integer.parseInt(lengthString);
				} catch (Exception e) {
				}
			}

			StringBuffer sb = new StringBuffer();
			for (int i = 0; i < length; i++) {
				sb.append(" ");
			}
			String newPattern = TextUtils.replace(template.getPattern(), TAB,
					sb.toString());
			template = new Template(template.getName(), template
					.getDescription(), template.getContextTypeId(), newPattern,
					template.isAutoInsertable());

		}
		TemplateBuffer result = super.evaluate(template);
		return result;
	}

