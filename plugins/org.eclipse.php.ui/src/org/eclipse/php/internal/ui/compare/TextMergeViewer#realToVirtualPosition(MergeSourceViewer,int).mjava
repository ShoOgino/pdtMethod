	/*
	 * Returns the virtual position for the given view position.
	 */
	private int realToVirtualPosition(MergeSourceViewer w, int vpos) {

		if (!fSynchronizedScrolling || fAllDiffs == null)
			return vpos;

		int viewPos = 0; // real view position
		int virtualPos = 0; // virtual position
		Point region = new Point(0, 0);

		Iterator e = fAllDiffs.iterator();
		while (e.hasNext()) {
			Diff diff = (Diff) e.next();
			Position pos = diff.getPosition(w);
			w.getLineRange(pos, region);
			int realHeight = region.y;
			int virtualHeight = diff.getMaxDiffHeight();
			if (vpos <= viewPos + realHeight) { // OK, found!
				vpos -= viewPos; // make relative to this slot
				// now scale position within this slot to virtual slot
				if (realHeight <= 0)
					vpos = 0;
				else
					vpos = (vpos * virtualHeight) / realHeight;
				return virtualPos + vpos;
			}
			viewPos += realHeight;
			virtualPos += virtualHeight;
		}
		return virtualPos;
	}

