	private int getOffset(IDocument document, LinePosition position) throws BadLocationException {
		int result;
		int lineLength = document.getLineLength(position.line);
		if (position.offset <= lineLength) {
			result = position.offset + document.getLineOffset(position.line);
		} else {
			result = lineLength + document.getLineOffset(position.line);
		}
		return result;
	}

