	public void setData(int offset, CodeData[] data, String key, int selectionLength, boolean isKeyStrict) {
		setOffset(offset);
		if (isKeyStrict) {
			ArrayList strictData = new ArrayList(1);
			for (int i = 0; i < data.length; ++i)
				if (key.equalsIgnoreCase(data[i].getName())) {
					strictData.add(data[i]);
				}
			data = (CodeData[]) strictData.toArray(new CodeData[strictData.size()]);
		}
		setCodeDataProposals(data);
		this.key = key;
		if (key != null) {
			IPath keyPath = new Path(key.replaceAll(ELEMENT_NAME_SEPARATOR, "/"));
			matchingSegments = keyPath.segmentCount();
			if (matchingSegments > 0 && !keyPath.hasTrailingSeparator()) {
				--matchingSegments;
			}
		} else {
			matchingSegments = 0;
		}

		this.selectionLength = selectionLength;
	}

