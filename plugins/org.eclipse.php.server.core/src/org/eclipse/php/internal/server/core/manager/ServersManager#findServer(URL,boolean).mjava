	/**
	 * Tries to find and return a server that corresponds to given URL. If
	 * perfect match flag is set to <code>false</code> then only host address is
	 * being used to find the server, otherwise a port and protocol are being
	 * taken into account to find appropriate match.
	 * 
	 * @param url
	 * @param perfectMatch
	 * @return server that corresponds to given URL
	 */
	public static Server findServer(URL url, boolean perfectMatch) {
		String urlHostAddress = url.getHost();
		try {
			InetAddress urlHostInetAddress = InetAddress
					.getByName(urlHostAddress);
			// Resolve it to IP address
			urlHostAddress = urlHostInetAddress.getHostAddress();
		} catch (UnknownHostException e) {
			// may not exists - ignore
		}
		for (Server server : getServers()) {
			URL serverURL;
			try {
				serverURL = new URL(server.getBaseURL());
			} catch (MalformedURLException ex) {
				// Should not happen
				continue;
			}
			String serverHost = serverURL.getHost();
			try {
				InetAddress serverHostAddress = InetAddress
						.getByName(serverHost);
				if (urlHostAddress.equals(serverHostAddress.getHostAddress())) {
					if (!perfectMatch)
						return server;
					if (url.getPort() == serverURL.getPort()
							&& url.getProtocol()
									.equals(serverURL.getProtocol()))
						return server;
				}
			} catch (UnknownHostException e) {
				// ignore
			}
		}
		return null;
	}

