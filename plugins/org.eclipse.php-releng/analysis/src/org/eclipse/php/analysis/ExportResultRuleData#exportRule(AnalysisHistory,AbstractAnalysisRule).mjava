	protected String exportRule(AnalysisHistory history, AbstractAnalysisRule rule) {
		StringBuffer resultString = new StringBuffer();
		List results = rule.getHistoryResults(history.getHistoryId());
		if (results != null && results.size() > 0) {
			//Generate results into a new stringbuffer
			StringBuffer sb = new StringBuffer();
			for (Iterator it = results.iterator(); it.hasNext();) {
				AbstractAnalysisResult child = (AbstractAnalysisResult) it.next();
				if (child.isVisible()) {
					String report = exportResult(history, child);
					if (report != null) {
						sb.append(report);
					}
				}
			}

			// If there were any results, then write the rule/result block
			if (sb.length() > 0) {
				resultString.append(getRuleHeader(rule));
				resultString.append(sb);
				resultString.append(getFooter(rule));
			}
		}

		return resultString.toString();
	}

