    private SummaryEntry[] internalQuerySummaries(Variations variationPatterns, String scenarioPattern) {
        if (fSQL == null)
            return null;
        long start = System.currentTimeMillis();
        if (DEBUG) System.out.print("	- query summaries from DB for scenario pattern '"+scenarioPattern+"'..."); //$NON-NLS-1$ //$NON-NLS-2$
		ResultSet result = null;
        try {
            List fingerprints= new ArrayList();
            if (scenarioPattern != null)
                result= fSQL.querySummaryEntries(variationPatterns, scenarioPattern);
            else
                result= fSQL.queryGlobalSummaryEntries(variationPatterns);
            while (result.next()) {
                String scenarioName= result.getString(1);
                String shortName= result.getString(2);
                int dim_id= result.getInt(3);
                boolean isGlobal= result.getShort(4) == 1;
                int comment_id= result.getInt(5);
                int commentKind= 0;
                String comment= null;
                if (comment_id != 0) {
                		ResultSet rs2= fSQL.getComment(comment_id);
                		if (rs2.next()) {
                			commentKind= rs2.getInt(1);
                			comment= rs2.getString(2);
                		}
                }
                if (dim_id != 0) {
	                fingerprints.add(new SummaryEntry(scenarioName, shortName, Dim.getDimension(dim_id), isGlobal, commentKind, comment));
                }
            }
            return (SummaryEntry[])fingerprints.toArray(new SummaryEntry[fingerprints.size()]);
        } catch (SQLException e) {
	        PerformanceTestPlugin.log(e);
        } finally {
            if (result != null) {
                try {
                    result.close();
                } catch (SQLException e1) {
                	// ignored
                }
            }
            if (DEBUG) {
		        long time = System.currentTimeMillis();
            	System.out.println("done in "+(time-start)+"ms"); //$NON-NLS-1$ //$NON-NLS-2$
            }
        }
        return null;
    }

