    private void disconnect() {
		if (DEBUG) {
			if (fStoreCalled)
				System.out.println("stored " + fStoredSamples + " new datapoints in DB"); //$NON-NLS-1$ //$NON-NLS-2$
			System.out.println("disconnecting from DB"); //$NON-NLS-1$
		}
        if (fSQL != null) {
            try {
                fSQL.dispose();
            } catch (SQLException e1) {
    	        PerformanceTestPlugin.log(e1);
            }
            fSQL= null;
        }
        if (fConnection != null) {
            try {
                fConnection.commit();
            } catch (SQLException e) {
    	        PerformanceTestPlugin.log(e);
            }
            try {
                 fConnection.close();
            } catch (SQLException e) {
    	        PerformanceTestPlugin.log(e);
            }
            fConnection= null;
        }
        
        if (fIsEmbedded) {
	        try {
	            DriverManager.getConnection("jdbc:" + fDBType + ":;shutdown=true"); //$NON-NLS-1$ //$NON-NLS-2$
	        } catch (SQLException e) {
	            String message= e.getMessage();
	            if (message.indexOf("system shutdown.") < 0) //$NON-NLS-1$
	                e.printStackTrace();
	        }
        }
    }

