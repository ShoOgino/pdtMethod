	private Statistics computeStats(Dim dimension) {
	    		
	    Statistics stats;
		
		Set steps= new HashSet();
		for (int j= 0; j < fDataPoints.length; j++) {
		    DataPoint dp= fDataPoints[j];
		    steps.add(new Integer(dp.getStep()));
		}
        
        if (steps.contains(new Integer(InternalPerformanceMeter.AVERAGE))) {
            // an already aggregated set of data points from the DB
            stats= computeStatsFromAggregates(dimension);
        } else if (steps.contains(new Integer(InternalPerformanceMeter.AFTER))) {
            // raw values from measurement
            stats= computeStatsFromMeasurements(dimension, steps);
        } else {
            Assert.fail("illegal data set: contains neither AVERAGE nor AFTER values."); //$NON-NLS-1$
            stats= null; // dummy
        }

		return stats;
	}

