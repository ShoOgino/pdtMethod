	public static CompletionProposal[] getProposals(ISourceModule sourceModule, int offset) throws ModelException {
		final List<CompletionProposal> proposals = new LinkedList<CompletionProposal>();
		sourceModule.codeComplete(offset, new CompletionRequestor() {
			@Override
			public void accept(CompletionProposal proposal) {
				proposals.add(proposal);
			}
		});
		return proposals.toArray(new CompletionProposal[proposals.size()]);
	}

